<svg xmlns="http://www.w3.org/2000/svg" contentStyleType="text/css" data-diagram-type="CLASS" height="1277px"
     preserveAspectRatio="none" style="width:5252px;height:1277px;background:#FFFFFF;" version="1.1"
     viewBox="0 0 5252 1277" width="5252px" zoomAndPan="magnify"><title>Syst&#232;me de Commandes - D&#233;taill&#233;</title><defs/><g><g class="title" data-source-line="5"><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="236.1371" x="2500.9315" y="24.9659">Syst&#232;me de Commandes - D&#233;taill&#233;</text></g><!--cluster Command Pattern Core--><g class="cluster" data-entity="Command Pattern Core" data-source-line="10" data-uid="ent0002" id="cluster_Command Pattern Core"><rect fill="none" height="796.2" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.5;" width="691" x="4555" y="475.5979"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="163.9534" x="4818.5233" y="492.5639">Command Pattern Core</text></g><!--cluster Concrete Commands--><g class="cluster" data-entity="Concrete Commands" data-source-line="60" data-uid="ent0012" id="cluster_Concrete Commands"><rect fill="none" height="755.18" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.5;" width="1429" x="801" y="187.8379"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="145.1514" x="1442.9243" y="204.8039">Concrete Commands</text></g><!--cluster ACK System--><g class="cluster" data-entity="ACK System" data-source-line="124" data-uid="ent0026" id="cluster_ACK System"><rect fill="none" height="216.41" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.5;" width="574" x="7" y="494.6679"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="82.4317" x="252.7842" y="511.6339">ACK System</text></g><!--cluster Client Integration--><g class="cluster" data-entity="Client Integration" data-source-line="146" data-uid="ent0031" id="cluster_Client Integration"><rect fill="none" height="512.41" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.5;" width="1680" x="2851" y="140.1679"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="125.1035" x="3628.4482" y="157.1339">Client Integration</text></g><!--class PendingCommand--><g class="entity" data-entity="PendingCommand" data-source-line="12" data-uid="ent0003" id="entity_PendingCommand"><rect fill="#F1F1F1" height="105.2038" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="354.3127" x="4570.84" y="812.2779"/><ellipse cx="4685.8846" cy="828.2779" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M4681.9158,834.7779 L4681.9158,833.0748 L4684.2752,832.8092 L4684.2752,824.606 L4681.9158,824.3404 L4681.9158,822.6373 L4689.0565,822.6373 L4689.0565,824.3404 L4686.6346,824.606 L4686.6346,832.8092 L4689.0565,833.0748 L4689.0565,834.7779 L4681.9158,834.7779 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="115.7236" x="4706.3846" y="833.7099">PendingCommand</text><line style="stroke:#181818;stroke-width:0.5;" x1="4571.84" x2="4924.1527" y1="844.2779" y2="844.2779"/><line style="stroke:#181818;stroke-width:0.5;" x1="4571.84" x2="4924.1527" y1="852.2779" y2="852.2779"/><ellipse cx="4581.84" cy="867.3119" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158.7174" x="4590.84" y="871.2439">getCommandId(): String</text><ellipse cx="4581.84" cy="886.3798" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="328.3127" x="4590.84" y="890.3118">onAckReceived(ackType: MessageStatus): boolean</text><ellipse cx="4581.84" cy="905.4477" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="214.8572" x="4590.84" y="909.3797">onAckFailed(reason: String): void</text></g><g class="entity" data-entity="GMN4" data-source-line="19" data-uid="ent0005" id="entity_GMN4"><path d="M4587.97,1015.6179 L4587.97,1255.7961 A0,0 0 0 0 4587.97,1255.7961 L4908.0353,1255.7961 A0,0 0 0 0 4908.0353,1255.7961 L4908.0353,1025.6179 L4898.0353,1015.6179 L4752,1015.6179 L4748,917.7479 L4744,1015.6179 L4587.97,1015.6179 A0,0 0 0 0 4587.97,1015.6179" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M4898.0353,1015.6179 L4898.0353,1025.6179 L4908.0353,1025.6179 L4898.0353,1015.6179" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="122.4731" x="4593.97" y="1034.5149">Pattern: Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="4593.97" y="1052.2209">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.3392" x="4593.97" y="1069.927">Encapsule une action qui attend une</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.0182" x="4593.97" y="1087.633">confirmation (ACK) du serveur.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="4593.97" y="1105.339">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.9371" x="4593.97" y="1123.045">Permet de:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.1362" x="4593.97" y="1140.751">- Annuler une action si timeout</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246.7402" x="4593.97" y="1158.457">- Mettre &#224; jour l'&#233;tat en fonction de l'ACK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244.0882" x="4593.97" y="1176.1631">- G&#233;rer les erreurs de mani&#232;re uniforme</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="4593.97" y="1193.8691">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="299.0653" x="4593.97" y="1211.5751">Quand la m&#233;thode onAckReceived retourne true,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="283.2962" x="4593.97" y="1229.2811">la commande est consid&#233;r&#233;e comme termin&#233;e</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213.9542" x="4593.97" y="1246.9871">et sera supprim&#233;e du gestionnaire.</text></g><!--class PendingCommandManager--><g class="entity" data-entity="PendingCommandManager" data-source-line="34" data-uid="ent0007" id="entity_PendingCommandManager"><rect fill="#F1F1F1" height="200.5433" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="464.8984" x="4570.55" y="513.5979"/><ellipse cx="4707.5186" cy="529.5979" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M4706.9873,536.5198 Q4705.2373,536.5198 4704.0967,535.7854 Q4702.9717,535.0354 4702.4092,533.6917 Q4701.8623,532.3323 4701.8623,530.5354 Q4701.8623,528.5042 4702.5186,527.051 Q4703.1748,525.5979 4704.4561,524.8167 Q4705.7373,524.0354 4707.6123,524.0354 Q4708.5029,524.0354 4709.1748,524.2229 Q4709.8467,524.3948 4710.5342,524.7385 L4709.7217,526.7542 Q4709.0967,526.4417 4708.5498,526.3167 Q4708.0186,526.1917 4707.5342,526.1917 Q4706.3623,526.1917 4705.6592,526.7229 Q4704.9561,527.2542 4704.6592,528.2073 Q4704.3623,529.1604 4704.3623,530.426 Q4704.3623,532.4417 4705.0811,533.4104 Q4705.7998,534.3635 4707.3936,534.3635 Q4707.9873,534.3635 4708.6123,534.2073 Q4709.2373,534.051 4710.0654,533.676 L4710.0654,535.8948 Q4709.3311,536.2073 4708.5342,536.3635 Q4707.7529,536.5198 4706.9873,536.5198 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="182.4613" x="4728.0186" y="535.0299">PendingCommandManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="4571.55" x2="5034.4484" y1="545.5979" y2="545.5979"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="4578.55" y="557.6319"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="352.4347" x="4590.55" y="564.5639">pendingCommands: Map&lt;String, PendingCommand&gt;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="4578.55" y="576.6998"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="244.719" x="4590.55" y="583.6318">scheduler: ScheduledExecutorService</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="4578.55" y="595.7677"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="252.629" x="4590.55" y="602.6997">DEFAULT_TIMEOUT_MS: long = 30_000</text><line style="stroke:#181818;stroke-width:1;" x1="4571.55" x2="5034.4484" y1="610.8017" y2="610.8017"/><ellipse cx="4581.55" cy="625.8356" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190.8613" x="4590.55" y="629.7676">PendingCommandManager()</text><ellipse cx="4581.55" cy="644.9035" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="388.7786" x="4590.55" y="648.8355">addPendingCommand(command: PendingCommand): void</text><ellipse cx="4581.55" cy="663.9715" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="222.9631" x="4590.55" y="667.9034">handleAck(ack: AckMessage): void</text><ellipse cx="4581.55" cy="683.0394" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="438.8984" x="4590.55" y="686.9714">removePendingCommand(commandId: String): PendingCommand</text><ellipse cx="4581.55" cy="702.1073" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109.3956" x="4590.55" y="706.0393">shutdown(): void</text></g><g class="entity" data-entity="GMN8" data-source-line="47" data-uid="ent0009" id="entity_GMN8"><path d="M4960.13,815.6179 L4960.13,914.148 A0,0 0 0 0 4960.13,914.148 L5229.8722,914.148 A0,0 0 0 0 5229.8722,914.148 L5229.8722,825.6179 L5219.8722,815.6179 L5001.79,815.6179 L4997.79,714.5179 L4993.79,815.6179 L4960.13,815.6179 A0,0 0 0 0 4960.13,815.6179" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M5219.8722,815.6179 L5219.8722,825.6179 L5229.8722,825.6179 L5219.8722,815.6179" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.3651" x="4966.13" y="834.5149">Responsabilit&#233;s:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239.3952" x="4966.13" y="852.2209">1. G&#233;rer le cycle de vie des commandes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246.5972" x="4966.13" y="869.927">2. Timeout automatique (30s par d&#233;faut)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194.2852" x="4966.13" y="887.633">3. Mapper ACK aux commandes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.7422" x="4966.13" y="905.339">4. Thread-safe avec ConcurrentHashMap</text></g><!--class SendTextMessageCommand--><g class="entity" data-entity="SendTextMessageCommand" data-source-line="62" data-uid="ent0013" id="entity_SendTextMessageCommand"><rect fill="#F1F1F1" height="181.4754" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="758.4354" x="816.78" y="523.1379"/><ellipse cx="1097.7661" cy="539.1379" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M1097.2348,546.0598 Q1095.4848,546.0598 1094.3442,545.3254 Q1093.2192,544.5754 1092.6567,543.2317 Q1092.1098,541.8723 1092.1098,540.0754 Q1092.1098,538.0442 1092.7661,536.591 Q1093.4223,535.1379 1094.7036,534.3567 Q1095.9848,533.5754 1097.8598,533.5754 Q1098.7504,533.5754 1099.4223,533.7629 Q1100.0942,533.9348 1100.7817,534.2785 L1099.9692,536.2942 Q1099.3442,535.9817 1098.7973,535.8567 Q1098.2661,535.7317 1097.7817,535.7317 Q1096.6098,535.7317 1095.9067,536.2629 Q1095.2036,536.7942 1094.9067,537.7473 Q1094.6098,538.7004 1094.6098,539.966 Q1094.6098,541.9817 1095.3286,542.9504 Q1096.0473,543.9035 1097.6411,543.9035 Q1098.2348,543.9035 1098.8598,543.7473 Q1099.4848,543.591 1100.3129,543.216 L1100.3129,545.4348 Q1099.5786,545.7473 1098.7817,545.9035 Q1098.0004,546.0598 1097.2348,546.0598 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="187.9633" x="1118.2661" y="544.5699">SendTextMessageCommand</text><line style="stroke:#181818;stroke-width:0.5;" x1="817.78" x2="1574.2154" y1="555.1379" y2="555.1379"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="824.78" y="567.1719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126.6295" x="836.78" y="574.1039">commandId: String</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="824.78" y="586.2398"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.5155" x="836.78" y="593.1718">message: Message</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="824.78" y="605.3077"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="358.0487" x="836.78" y="612.2397">conversationRepository: ConversationClientRepository</text><line style="stroke:#181818;stroke-width:1;" x1="817.78" x2="1574.2154" y1="620.3417" y2="620.3417"/><ellipse cx="827.78" cy="635.3756" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="732.4354" x="836.78" y="639.3076">SendTextMessageCommand(commandId: String, message: Message, repository: ConversationClientRepository)</text><ellipse cx="827.78" cy="654.4435" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158.7174" x="836.78" y="658.3755">getCommandId(): String</text><ellipse cx="827.78" cy="673.5115" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="328.3127" x="836.78" y="677.4434">onAckReceived(ackType: MessageStatus): boolean</text><ellipse cx="827.78" cy="692.5794" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="214.8572" x="836.78" y="696.5114">onAckFailed(reason: String): void</text></g><!--class PendingCommand--><g class="entity" data-entity="PendingCommand" data-source-line="63" data-uid="ent0014" id="entity_PendingCommand"><rect fill="#F1F1F1" height="48" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="147.7236" x="1480.14" y="225.8379"/><ellipse cx="1495.14" cy="241.8379" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M1491.1713,248.3379 L1491.1713,246.6348 L1493.5306,246.3692 L1493.5306,238.166 L1491.1713,237.9004 L1491.1713,236.1973 L1498.3119,236.1973 L1498.3119,237.9004 L1495.89,238.166 L1495.89,246.3692 L1498.3119,246.6348 L1498.3119,248.3379 L1491.1713,248.3379 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="115.7236" x="1509.14" y="247.2699">PendingCommand</text><line style="stroke:#181818;stroke-width:0.5;" x1="1481.14" x2="1626.8636" y1="257.8379" y2="257.8379"/><line style="stroke:#181818;stroke-width:0.5;" x1="1481.14" x2="1626.8636" y1="265.8379" y2="265.8379"/></g><!--class SendManagementMessageCommand--><g class="entity" data-entity="SendManagementMessageCommand" data-source-line="73" data-uid="ent0016" id="entity_SendManagementMessageCommand"><rect fill="#F1F1F1" height="143.3396" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="603.8759" x="1610.06" y="542.1979"/><ellipse cx="1791.8494" cy="558.1979" fill="#A9DCDF" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M1787.0212,563.9479 L1790.365,551.7604 L1793.5056,551.7604 L1796.8806,563.9479 L1794.4119,563.9479 L1793.6775,560.9323 L1790.1619,560.9323 L1789.4119,563.9479 L1787.0212,563.9479 Z M1791.4275,555.901 L1790.6775,558.901 L1793.1931,558.901 L1792.4744,555.901 Q1792.3337,555.3229 1792.2087,554.776 Q1792.0837,554.2135 1791.9431,553.6354 Q1791.8337,554.2135 1791.6931,554.776 Q1791.5525,555.3229 1791.4275,555.901 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="231.7971" x="1812.3494" y="563.6299">SendManagementMessageCommand</text><line style="stroke:#181818;stroke-width:0.5;" x1="1611.06" x2="2212.9359" y1="574.1979" y2="574.1979"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="1618.06" y="586.2319"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126.6295" x="1630.06" y="593.1639">commandId: String</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="1618.06" y="605.2998"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="187.3753" x="1630.06" y="612.2318">messageType: MessageType</text><line style="stroke:#181818;stroke-width:1;" x1="1611.06" x2="2212.9359" y1="620.3338" y2="620.3338"/><ellipse cx="1621.06" cy="635.3677" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="577.8759" x="1630.06" y="639.2997">SendManagementMessageCommand(commandId: String, messageType: MessageType)</text><ellipse cx="1621.06" cy="654.4356" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158.7174" x="1630.06" y="658.3676">getCommandId(): String</text><ellipse cx="1621.06" cy="673.5035" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="214.8572" x="1630.06" y="677.4355">onAckFailed(reason: String): void</text></g><!--class UpdatePseudoCommand--><g class="entity" data-entity="UpdatePseudoCommand" data-source-line="82" data-uid="ent0018" id="entity_UpdatePseudoCommand"><rect fill="#F1F1F1" height="105.2038" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="457.2404" x="1128.38" y="812.2779"/><ellipse cx="1269.9125" cy="828.2779" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M1269.3813,835.1998 Q1267.6313,835.1998 1266.4907,834.4654 Q1265.3657,833.7154 1264.8032,832.3717 Q1264.2563,831.0123 1264.2563,829.2154 Q1264.2563,827.1842 1264.9125,825.731 Q1265.5688,824.2779 1266.85,823.4967 Q1268.1313,822.7154 1270.0063,822.7154 Q1270.8969,822.7154 1271.5688,822.9029 Q1272.2407,823.0748 1272.9282,823.4185 L1272.1157,825.4342 Q1271.4907,825.1217 1270.9438,824.9967 Q1270.4125,824.8717 1269.9282,824.8717 Q1268.7563,824.8717 1268.0532,825.4029 Q1267.35,825.9342 1267.0532,826.8873 Q1266.7563,827.8404 1266.7563,829.106 Q1266.7563,831.1217 1267.475,832.0904 Q1268.1938,833.0435 1269.7875,833.0435 Q1270.3813,833.0435 1271.0063,832.8873 Q1271.6313,832.731 1272.4594,832.356 L1272.4594,834.5748 Q1271.725,834.8873 1270.9282,835.0435 Q1270.1469,835.1998 1269.3813,835.1998 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="165.6754" x="1290.4125" y="833.7099">UpdatePseudoCommand</text><line style="stroke:#181818;stroke-width:0.5;" x1="1129.38" x2="1584.6204" y1="844.2779" y2="844.2779"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="1136.38" y="856.3119"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123.1435" x="1148.38" y="863.2439">newPseudo: String</text><line style="stroke:#181818;stroke-width:1;" x1="1129.38" x2="1584.6204" y1="871.3458" y2="871.3458"/><ellipse cx="1139.38" cy="886.3798" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="431.2404" x="1148.38" y="890.3118">UpdatePseudoCommand(commandId: String, newPseudo: String)</text><ellipse cx="1139.38" cy="905.4477" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="328.3127" x="1148.38" y="909.3797">onAckReceived(ackType: MessageStatus): boolean</text></g><!--class OtherExampleCommand--><g class="entity" data-entity="OtherExampleCommand" data-source-line="89" data-uid="ent0020" id="entity_OtherExampleCommand"><rect fill="#F1F1F1" height="124.2717" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="589.4979" x="1620.25" y="802.7479"/><ellipse cx="1829.1573" cy="818.7479" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M1828.626,825.6698 Q1826.876,825.6698 1825.7354,824.9354 Q1824.6104,824.1854 1824.0479,822.8417 Q1823.501,821.4823 1823.501,819.6854 Q1823.501,817.6542 1824.1573,816.201 Q1824.8135,814.7479 1826.0948,813.9667 Q1827.376,813.1854 1829.251,813.1854 Q1830.1416,813.1854 1830.8135,813.3729 Q1831.4854,813.5448 1832.1729,813.8885 L1831.3604,815.9042 Q1830.7354,815.5917 1830.1885,815.4667 Q1829.6573,815.3417 1829.1729,815.3417 Q1828.001,815.3417 1827.2979,815.8729 Q1826.5948,816.4042 1826.2979,817.3573 Q1826.001,818.3104 1826.001,819.576 Q1826.001,821.5917 1826.7198,822.5604 Q1827.4385,823.5135 1829.0323,823.5135 Q1829.626,823.5135 1830.251,823.3573 Q1830.876,823.201 1831.7041,822.826 L1831.7041,825.0448 Q1830.9698,825.3573 1830.1729,825.5135 Q1829.3916,825.6698 1828.626,825.6698 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="163.1834" x="1849.6573" y="824.1799">OtherExampleCommand</text><line style="stroke:#181818;stroke-width:0.5;" x1="1621.25" x2="2208.7479" y1="834.7479" y2="834.7479"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="1628.25" y="846.7819"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108.9336" x="1640.25" y="853.7139">targetUserId: int</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="1628.25" y="865.8498"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141.5675" x="1640.25" y="872.7818">someOtherField: type</text><line style="stroke:#181818;stroke-width:1;" x1="1621.25" x2="2208.7479" y1="880.8838" y2="880.8838"/><ellipse cx="1631.25" cy="895.9177" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="563.4979" x="1640.25" y="899.8497">OtherExampleCommand(commandId: String, targetUserId: int, someOtherField: type)</text><ellipse cx="1631.25" cy="914.9856" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="328.3127" x="1640.25" y="918.9176">onAckReceived(ackType: MessageStatus): boolean</text></g><!--class AckMessage--><g class="entity" data-entity="AckMessage" data-source-line="126" data-uid="ent0027" id="entity_AckMessage"><rect fill="#F1F1F1" height="162.4075" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="270.9711" x="22.51" y="532.6679"/><ellipse cx="112.9917" cy="548.6679" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M112.4604,555.5898 Q110.7104,555.5898 109.5698,554.8554 Q108.4448,554.1054 107.8823,552.7617 Q107.3354,551.4023 107.3354,549.6054 Q107.3354,547.5742 107.9917,546.121 Q108.6479,544.6679 109.9292,543.8867 Q111.2104,543.1054 113.0854,543.1054 Q113.9761,543.1054 114.6479,543.2929 Q115.3198,543.4648 116.0073,543.8085 L115.1948,545.8242 Q114.5698,545.5117 114.0229,545.3867 Q113.4917,545.2617 113.0073,545.2617 Q111.8354,545.2617 111.1323,545.7929 Q110.4292,546.3242 110.1323,547.2773 Q109.8354,548.2304 109.8354,549.496 Q109.8354,551.5117 110.5542,552.4804 Q111.2729,553.4335 112.8667,553.4335 Q113.4604,553.4335 114.0854,553.2773 Q114.7104,553.121 115.5386,552.746 L115.5386,554.9648 Q114.8042,555.2773 114.0073,555.4335 Q113.2261,555.5898 112.4604,555.5898 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.5077" x="133.4917" y="554.0999">AckMessage</text><line style="stroke:#181818;stroke-width:0.5;" x1="23.51" x2="292.4811" y1="564.6679" y2="564.6679"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="30.51" y="576.7019"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="213.9192" x="42.51" y="583.6339">acknowledgedMessageId: String</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="30.51" y="595.7698"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160.2434" x="42.51" y="602.7018">ackType: MessageStatus</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="30.51" y="614.8377"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128.7855" x="42.51" y="621.7697">errorReason: String</text><line style="stroke:#181818;stroke-width:1;" x1="23.51" x2="292.4811" y1="629.8717" y2="629.8717"/><ellipse cx="33.51" cy="644.9056" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="244.9711" x="42.51" y="648.8376">getAcknowledgedMessageId(): String</text><ellipse cx="33.51" cy="663.9735" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="191.2953" x="42.51" y="667.9055">getAckType(): MessageStatus</text><ellipse cx="33.51" cy="683.0415" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158.6334" x="42.51" y="686.9734">getErrorReason(): String</text></g><g class="entity" data-entity="GMN28" data-source-line="137" data-uid="ent0029" id="entity_GMN28"><path d="M328.68,582.3179 L328.68,609.7979 L293.61,613.7979 L328.68,617.7979 L328.68,645.436 A0,0 0 0 0 328.68,645.436 L565.3242,645.436 A0,0 0 0 0 565.3242,645.436 L565.3242,592.3179 L555.3242,582.3179 L328.68,582.3179 A0,0 0 0 0 328.68,582.3179" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M555.3242,582.3179 L555.3242,592.3179 L565.3242,592.3179 L555.3242,582.3179" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.5222" x="334.68" y="601.2149">Message d'acquittement envoy&#233;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.6442" x="334.68" y="618.9209">pour confirmer la r&#233;ception/lecture</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.4131" x="334.68" y="636.627">d'un message.</text></g><!--class Client--><g class="entity" data-entity="Client" data-source-line="148" data-uid="ent0032" id="entity_Client"><rect fill="#F1F1F1" height="124.2717" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="471.8004" x="3364.1" y="187.6979"/><ellipse cx="3576.9133" cy="203.6979" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M3576.382,210.6198 Q3574.632,210.6198 3573.4914,209.8854 Q3572.3664,209.1354 3571.8039,207.7917 Q3571.257,206.4323 3571.257,204.6354 Q3571.257,202.6042 3571.9133,201.151 Q3572.5695,199.6979 3573.8508,198.9167 Q3575.132,198.1354 3577.007,198.1354 Q3577.8977,198.1354 3578.5695,198.3229 Q3579.2414,198.4948 3579.9289,198.8385 L3579.1164,200.8542 Q3578.4914,200.5417 3577.9445,200.4167 Q3577.4133,200.2917 3576.9289,200.2917 Q3575.757,200.2917 3575.0539,200.8229 Q3574.3508,201.3542 3574.0539,202.3073 Q3573.757,203.2604 3573.757,204.526 Q3573.757,206.5417 3574.4758,207.5104 Q3575.1945,208.4635 3576.7883,208.4635 Q3577.382,208.4635 3578.007,208.3073 Q3578.632,208.151 3579.4602,207.776 L3579.4602,209.9948 Q3578.7258,210.3073 3577.9289,210.4635 Q3577.1477,210.6198 3576.382,210.6198 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.6738" x="3597.4133" y="209.1299">Client</text><line style="stroke:#181818;stroke-width:0.5;" x1="3365.1" x2="3834.9004" y1="219.6979" y2="219.6979"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="3372.1" y="231.7319"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="315.6848" x="3384.1" y="238.6639">commandManager: PendingCommandManager</text><line style="stroke:#181818;stroke-width:1;" x1="3365.1" x2="3834.9004" y1="246.7658" y2="246.7658"/><ellipse cx="3375.1" cy="261.7998" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="347.7726" x="3384.1" y="265.7318">getCommandManager(): PendingCommandManager</text><ellipse cx="3375.1" cy="280.8677" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="239.1611" x="3384.1" y="284.7997">sendPacket(packet: Packet): boolean</text><ellipse cx="3375.1" cy="299.9356" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="445.8004" x="3384.1" y="303.8676">sendAck(message: ProtocolMessage, ackType: MessageStatus): void</text></g><!--class ClientController--><g class="entity" data-entity="ClientController" data-source-line="156" data-uid="ent0033" id="entity_ClientController"><rect fill="#F1F1F1" height="143.3396" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="643.8738" x="3871.06" y="178.1679"/><ellipse cx="4136.8211" cy="194.1679" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M4136.2898,201.0898 Q4134.5398,201.0898 4133.3992,200.3554 Q4132.2742,199.6054 4131.7117,198.2617 Q4131.1648,196.9023 4131.1648,195.1054 Q4131.1648,193.0742 4131.8211,191.621 Q4132.4773,190.1679 4133.7586,189.3867 Q4135.0398,188.6054 4136.9148,188.6054 Q4137.8055,188.6054 4138.4773,188.7929 Q4139.1492,188.9648 4139.8367,189.3085 L4139.0242,191.3242 Q4138.3992,191.0117 4137.8523,190.8867 Q4137.3211,190.7617 4136.8367,190.7617 Q4135.6648,190.7617 4134.9617,191.2929 Q4134.2586,191.8242 4133.9617,192.7773 Q4133.6648,193.7304 4133.6648,194.996 Q4133.6648,197.0117 4134.3836,197.9804 Q4135.1023,198.9335 4136.6961,198.9335 Q4137.2898,198.9335 4137.9148,198.7773 Q4138.5398,198.621 4139.368,198.246 L4139.368,200.4648 Q4138.6336,200.7773 4137.8367,200.9335 Q4137.0555,201.0898 4136.2898,201.0898 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103.8516" x="4157.3211" y="199.5999">ClientController</text><line style="stroke:#181818;stroke-width:0.5;" x1="3872.06" x2="4513.9338" y1="210.1679" y2="210.1679"/><line style="stroke:#181818;stroke-width:1;" x1="3872.06" x2="4513.9338" y1="218.1679" y2="218.1679"/><ellipse cx="3882.06" cy="233.2019" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="347.7726" x="3891.06" y="237.1339">getCommandManager(): PendingCommandManager</text><ellipse cx="3882.06" cy="252.2698" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="360.4427" x="3891.06" y="256.2018">sendTextMessage(content: String, toUserId: int): String</text><ellipse cx="3882.06" cy="271.3377" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="617.8738" x="3891.06" y="275.2697">sendManagementMessage(messageType: MessageType, toUserId: int): ManagementMessage</text><ellipse cx="3882.06" cy="290.4056" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="287.9789" x="3891.06" y="294.3376">updatePseudo(newPseudo: String): boolean</text><ellipse cx="3882.06" cy="309.4735" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="256.843" x="3891.06" y="313.4055">removeContact(contactId: int): boolean</text></g><!--class AckMessageHandler--><g class="entity" data-entity="AckMessageHandler" data-source-line="165" data-uid="ent0034" id="entity_AckMessageHandler"><rect fill="#F1F1F1" height="67.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="462.3223" x="2866.84" y="216.2979"/><ellipse cx="3026.6074" cy="232.2979" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M3026.0762,239.2198 Q3024.3262,239.2198 3023.1855,238.4854 Q3022.0605,237.7354 3021.498,236.3917 Q3020.9512,235.0323 3020.9512,233.2354 Q3020.9512,231.2042 3021.6074,229.751 Q3022.2637,228.2979 3023.5449,227.5167 Q3024.8262,226.7354 3026.7012,226.7354 Q3027.5918,226.7354 3028.2637,226.9229 Q3028.9355,227.0948 3029.623,227.4385 L3028.8105,229.4542 Q3028.1855,229.1417 3027.6387,229.0167 Q3027.1074,228.8917 3026.623,228.8917 Q3025.4512,228.8917 3024.748,229.4229 Q3024.0449,229.9542 3023.748,230.9073 Q3023.4512,231.8604 3023.4512,233.126 Q3023.4512,235.1417 3024.1699,236.1104 Q3024.8887,237.0635 3026.4824,237.0635 Q3027.0762,237.0635 3027.7012,236.9073 Q3028.3262,236.751 3029.1543,236.376 L3029.1543,238.5948 Q3028.4199,238.9073 3027.623,239.0635 Q3026.8418,239.2198 3026.0762,239.2198 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134.2875" x="3047.1074" y="237.7299">AckMessageHandler</text><line style="stroke:#181818;stroke-width:0.5;" x1="2867.84" x2="3328.1623" y1="248.2979" y2="248.2979"/><line style="stroke:#181818;stroke-width:1;" x1="2867.84" x2="3328.1623" y1="256.2979" y2="256.2979"/><ellipse cx="2877.84" cy="271.3319" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="436.3223" x="2886.84" y="275.2639">handle(message: ProtocolMessage, context: ClientController): void</text></g><g class="entity" data-entity="GMN35" data-source-line="171" data-uid="ent0036" id="entity_GMN35"><path d="M2953.7,591.1679 L2953.7,636.5799 A0,0 0 0 0 2953.7,636.5799 L3242.3052,636.5799 A0,0 0 0 0 3242.3052,636.5799 L3242.3052,601.1679 L3232.3052,591.1679 L3102,591.1679 L3098,283.7579 L3094,591.1679 L2953.7,591.1679 A0,0 0 0 0 2953.7,591.1679" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3232.3052,591.1679 L3232.3052,601.1679 L3242.3052,601.1679 L3232.3052,591.1679" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.2742" x="2959.7" y="610.0649">Re&#231;oit les ACK du serveur et</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.6052" x="2959.7" y="627.7709">les transmet au PendingCommandManager</text></g><!--class MessageStatus--><g class="entity" data-entity="MessageStatus" data-source-line="101" data-uid="ent0022" id="entity_MessageStatus"><rect fill="#F1F1F1" height="181.4754" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="266.2111" x="518.89" y="774.1479"/><ellipse cx="598.0597" cy="790.1479" fill="#EB937F" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M594.4191,796.6479 L594.4191,784.5073 L602.0754,784.5073 L602.0754,786.6323 L596.7941,786.6323 L596.7941,789.2885 L601.8097,789.2885 L601.8097,791.4135 L596.7941,791.4135 L596.7941,794.5229 L602.0754,794.5229 L602.0754,796.6479 L594.4191,796.6479 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.3716" x="618.5597" y="795.5799">MessageStatus</text><line style="stroke:#181818;stroke-width:0.5;" x1="519.89" x2="784.1011" y1="806.1479" y2="806.1479"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61.9077" x="524.89" y="825.1139">SENDING</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.8939" x="524.89" y="844.1818">SENT</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.9817" x="524.89" y="863.2497">DELIVERED</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35.6579" x="524.89" y="882.3176">READ</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.2978" x="524.89" y="901.3855">FAILED</text><line style="stroke:#181818;stroke-width:1;" x1="519.89" x2="784.1011" y1="909.4875" y2="909.4875"/><ellipse cx="529.89" cy="924.5215" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="240.2111" x="538.89" y="928.4534">fromString(s: String): MessageStatus</text><ellipse cx="529.89" cy="943.5894" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108.1076" x="538.89" y="947.5214">toString(): String</text></g><g class="entity" data-entity="GMN23" data-source-line="113" data-uid="ent0024" id="entity_GMN23"><path d="M529.69,1077.5879 L529.69,1193.824 A0,0 0 0 0 529.69,1193.824 L774.3162,1193.824 A0,0 0 0 0 774.3162,1193.824 L774.3162,1087.5879 L764.3162,1077.5879 L656,1077.5879 L652,955.8179 L648,1077.5879 L529.69,1077.5879 A0,0 0 0 0 529.69,1077.5879" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M764.3162,1077.5879 L764.3162,1087.5879 L774.3162,1087.5879 L764.3162,1077.5879" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.8982" x="535.69" y="1096.4849">&#201;tats d'un message dans le syst&#232;me:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.8862" x="535.69" y="1114.1909">- SENDING: en cours d'envoi</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.6281" x="535.69" y="1131.897">- SENT: re&#231;u par le serveur</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223.6262" x="535.69" y="1149.603">- DELIVERED: re&#231;u par le destinataire</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.3812" x="535.69" y="1167.309">- READ: lu par le destinataire</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.0881" x="535.69" y="1185.015">- FAILED: &#233;chec d'envoi</text></g><g class="entity" data-entity="SequenceDiagram" data-source-line="184" data-uid="ent0041" id="entity_SequenceDiagram"><path d="M2246.41,46.0679 L2246.41,453.6003 L2831.5915,453.6003 L2831.5915,56.0679 L2821.5915,46.0679 L2246.41,46.0679" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2821.5915,46.0679 L2821.5915,56.0679 L2831.5915,56.0679 L2821.5915,46.0679" fill="#FEFFDD" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="259.0252" x="2252.41" y="64.9649">S&#233;quence d'envoi de message avec ACK:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="2252.41" y="82.6709">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.5723" x="2252.41" y="100.377">1. User -&gt; ClientController: sendTextMessage("Hello", 2)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.2362" x="2252.41" y="118.083">2. ClientController -&gt; Message: create()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="328.5233" x="2252.41" y="135.789">3. ClientController -&gt; Conversation: addMessage(msg)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="415.9224" x="2252.41" y="153.495">4. ClientController -&gt; SendTextMessageCommand: new(msgId, msg)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="477.2045" x="2252.41" y="171.201">5. ClientController -&gt; PendingCommandManager: addPendingCommand(cmd)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="408.1354" x="2252.41" y="188.907">6. PendingCommandManager -&gt; Scheduler: schedule timeout (30s)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="362.5314" x="2252.41" y="206.6131">7. ClientController -&gt; Client: sendPacket(textMsg.toPacket())</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="2252.41" y="224.3191">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310.5703" x="2252.41" y="259.7311">8. Server -&gt; Client: AckMessage(msgId, DELIVERED)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="425.4775" x="2252.41" y="277.4371">9. AckMessageHandler -&gt; PendingCommandManager: handleAck(ack)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="558.1815" x="2252.41" y="295.1431">10. PendingCommandManager -&gt; SendTextMessageCommand: onAckReceived(DELIVERED)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="407.6154" x="2252.41" y="312.8492">11. SendTextMessageCommand -&gt; Message: setStatus(DELIVERED)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="511.9794" x="2252.41" y="330.5552">12. SendTextMessageCommand -&gt; EventBus: publish(MessageStatusChangedEvent)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="2252.41" y="348.2612">&#160;</text><line style="stroke:#181818;stroke-width:1;" x1="2247.41" x2="2497.0367" y1="236.9811" y2="236.9811"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.9281" x="2497.0367" y="241.5251">- Si ACK re&#231;u -</text><line style="stroke:#181818;stroke-width:1;" x1="2580.9648" x2="2830.5915" y1="236.9811" y2="236.9811"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="370.0193" x="2252.41" y="387.6732">8. Scheduler -&gt; PendingCommandManager: timeout callback</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="526.0456" x="2252.41" y="405.3792">9. PendingCommandManager -&gt; SendTextMessageCommand: onAckFailed("Timeout")</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="382.8374" x="2252.41" y="423.0853">10. SendTextMessageCommand -&gt; Message: setStatus(FAILED)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="511.9794" x="2252.41" y="440.7913">11. SendTextMessageCommand -&gt; EventBus: publish(MessageStatusChangedEvent)</text><line style="stroke:#181818;stroke-width:1;" x1="2247.41" x2="2500.4362" y1="364.9232" y2="364.9232"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.1291" x="2500.4362" y="369.4672">- Si timeout -</text><line style="stroke:#181818;stroke-width:1;" x1="2577.5653" x2="2830.5915" y1="364.9232" y2="364.9232"/></g><!--class PendingCommand--><g class="entity" data-entity="PendingCommand" data-source-line="211" data-uid="ent0042" id="entity_PendingCommand"><rect fill="#F1F1F1" height="48" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="155.1155" x="600.44" y="589.8679"/><ellipse cx="615.44" cy="605.8679" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M614.9088,612.7898 Q613.1588,612.7898 612.0181,612.0554 Q610.8931,611.3054 610.3306,609.9617 Q609.7838,608.6023 609.7838,606.8054 Q609.7838,604.7742 610.44,603.321 Q611.0963,601.8679 612.3775,601.0867 Q613.6588,600.3054 615.5338,600.3054 Q616.4244,600.3054 617.0963,600.4929 Q617.7681,600.6648 618.4556,601.0085 L617.6431,603.0242 Q617.0181,602.7117 616.4713,602.5867 Q615.94,602.4617 615.4556,602.4617 Q614.2838,602.4617 613.5806,602.9929 Q612.8775,603.5242 612.5806,604.4773 Q612.2838,605.4304 612.2838,606.696 Q612.2838,608.7117 613.0025,609.6804 Q613.7213,610.6335 615.315,610.6335 Q615.9088,610.6335 616.5338,610.4773 Q617.1588,610.321 617.9869,609.946 L617.9869,612.1648 Q617.2525,612.4773 616.4556,612.6335 Q615.6744,612.7898 614.9088,612.7898 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123.1155" x="629.44" y="611.2999">PendingCommand</text><line style="stroke:#181818;stroke-width:0.5;" x1="601.44" x2="754.5555" y1="621.8679" y2="621.8679"/><line style="stroke:#181818;stroke-width:0.5;" x1="601.44" x2="754.5555" y1="629.8679" y2="629.8679"/></g><!--reverse link PendingCommandManager to PendingCommand--><g class="link" data-entity-1="PendingCommandManager" data-entity-2="PendingCommand" data-source-line="54" data-uid="lnk11" id="link_PendingCommandManager_PendingCommand"><path codeLine="54" d="M4748,726.5179 C4748,759.9379 4748,783.7979 4748,812.1179" fill="none" id="PendingCommandManager-backto-PendingCommand" style="stroke:#181818;stroke-width:1;"/><polygon fill="none" points="4748,714.5179,4744,720.5179,4748,726.5179,4752,720.5179,4748,714.5179" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34.112" x="4711.6178" y="800.4496">many</text></g><!--reverse link PendingCommand to SendTextMessageCommand--><g class="link" data-entity-1="PendingCommand" data-entity-2="SendTextMessageCommand" data-source-line="63" data-uid="lnk15" id="link_PendingCommand_SendTextMessageCommand"><path d="M1527.68,292.2879 C1527.68,342.2679 1527.68,440.3579 1527.68,522.8579" fill="none" id="PendingCommand-backto-SendTextMessageCommand" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="none" points="1527.68,274.2879,1521.68,292.2879,1533.68,292.2879,1527.68,274.2879" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link PendingCommand to SendManagementMessageCommand--><g class="link" data-entity-1="PendingCommand" data-entity-2="SendManagementMessageCommand" data-source-line="74" data-uid="lnk17" id="link_PendingCommand_SendManagementMessageCommand"><path d="M1618.96,292.2879 C1618.96,346.2479 1618.96,459.2879 1618.96,541.9079" fill="none" id="PendingCommand-backto-SendManagementMessageCommand" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="none" points="1618.96,274.2879,1612.96,292.2879,1624.96,292.2879,1618.96,274.2879" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link SendManagementMessageCommand to UpdatePseudoCommand--><g class="link" data-entity-1="SendManagementMessageCommand" data-entity-2="UpdatePseudoCommand" data-source-line="83" data-uid="lnk19" id="link_SendManagementMessageCommand_UpdatePseudoCommand"><path d="M1616.85,703.7779 C1616.85,777.9279 1616.85,864.7979 1616.85,864.7979 C1616.85,864.7979 1604.86,864.7979 1586.03,864.7979" fill="none" id="SendManagementMessageCommand-backto-UpdatePseudoCommand" style="stroke:#181818;stroke-width:1;"/><polygon fill="none" points="1616.85,685.7779,1610.85,703.7779,1622.85,703.7779,1616.85,685.7779" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link SendManagementMessageCommand to OtherExampleCommand--><g class="link" data-entity-1="SendManagementMessageCommand" data-entity-2="OtherExampleCommand" data-source-line="90" data-uid="lnk21" id="link_SendManagementMessageCommand_OtherExampleCommand"><path d="M1915,703.7979 C1915,740.5979 1915,766.9579 1915,802.3279" fill="none" id="SendManagementMessageCommand-backto-OtherExampleCommand" style="stroke:#181818;stroke-width:1;"/><polygon fill="none" points="1915,685.7979,1909,703.7979,1921,703.7979,1915,685.7979" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link Client to PendingCommandManager--><g class="link" data-entity-1="Client" data-entity-2="PendingCommandManager" data-source-line="175" data-uid="lnk38" id="link_Client_PendingCommandManager"><path codeLine="175" d="M3600,324.4279 C3600,403.3279 3600,516.7979 3600,516.7979 C3600,516.7979 4220.63,516.7979 4570.34,516.7979" fill="none" id="Client-backto-PendingCommandManager" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3600,312.4279,3596,318.4279,3600,324.4279,3604,318.4279,3600,312.4279" style="stroke:#181818;stroke-width:1;"/></g><!--link ClientController to PendingCommandManager--><g class="link" data-entity-1="ClientController" data-entity-2="PendingCommandManager" data-source-line="176" data-uid="lnk39" id="link_ClientController_PendingCommandManager"><path codeLine="176" d="M4515.42,249.7979 C4661.9,249.7979 4803,249.7979 4803,249.7979 C4803,249.7979 4803,399.6579 4803,507.4279" fill="none" id="ClientController-to-PendingCommandManager" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="4803,513.4279,4807,504.4279,4803,508.4279,4799,504.4279,4803,513.4279" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.82" x="4763.02" y="245.6949">uses</text></g><!--link AckMessageHandler to PendingCommandManager--><g class="link" data-entity-1="AckMessageHandler" data-entity-2="PendingCommandManager" data-source-line="177" data-uid="lnk40" id="link_AckMessageHandler_PendingCommandManager"><path codeLine="177" d="M3285.73,283.7479 C3285.73,356.2579 3285.73,519.7979 3285.73,519.7979 C3285.73,519.7979 4138.76,519.7979 4564.08,519.7979" fill="none" id="AckMessageHandler-to-PendingCommandManager" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="4570.08,519.7979,4561.08,515.7979,4565.08,519.7979,4561.08,523.7979,4570.08,519.7979" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45.331" x="3763.88" y="515.6949">notifies</text></g><!--link PendingCommand to MessageStatus--><g class="link" data-entity-1="PendingCommand" data-entity-2="MessageStatus" data-source-line="211" data-uid="lnk43" id="link_PendingCommand_MessageStatus"><path codeLine="211" d="M678,637.9379 C678,669.1079 678,719.2079 678,767.8279" fill="none" id="PendingCommand-to-MessageStatus" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="678,773.8279,682,764.8279,678,768.8279,674,764.8279,678,773.8279" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.82" x="650" y="701.7749">uses</text></g><!--link AckMessage to MessageStatus--><g class="link" data-entity-1="AckMessage" data-entity-2="MessageStatus" data-source-line="212" data-uid="lnk44" id="link_AckMessage_MessageStatus"><path codeLine="212" d="M293.96,669.7979 C404.46,669.7979 542.11,669.7979 542.11,669.7979 C542.11,669.7979 542.11,717.0479 542.11,767.9079" fill="none" id="AckMessage-to-MessageStatus" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="542.11,773.9079,546.11,764.9079,542.11,768.9079,538.11,764.9079,542.11,773.9079" style="stroke:#181818;stroke-width:1;"/></g><!--link SendTextMessageCommand to MessageStatus--><g class="link" data-entity-1="SendTextMessageCommand" data-entity-2="MessageStatus" data-source-line="213" data-uid="lnk45" id="link_SendTextMessageCommand_MessageStatus"><path codeLine="213" d="M816.29,699.7979 C788.06,699.7979 770.33,699.7979 770.33,699.7979 C770.33,699.7979 770.33,729.4679 770.33,767.6479" fill="none" id="SendTextMessageCommand-to-MessageStatus" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="770.33,773.6479,774.33,764.6479,770.33,768.6479,766.33,764.6479,770.33,773.6479" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.569" x="720.33" y="709.6449">updates</text></g><!--link SendManagementMessageCommand to MessageStatus--><g class="link" data-entity-1="SendManagementMessageCommand" data-entity-2="MessageStatus" data-source-line="214" data-uid="lnk46" id="link_SendManagementMessageCommand_MessageStatus"><path codeLine="214" d="M1613.46,686.0279 C1613.46,734.2179 1613.46,788.7979 1613.46,788.7979 C1613.46,788.7979 1055.51,788.7979 791.43,788.7979" fill="none" id="SendManagementMessageCommand-to-MessageStatus" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="785.43,788.7979,794.43,792.7979,790.43,788.7979,794.43,784.7979,785.43,788.7979" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.82" x="1222.83" y="784.6949">uses</text></g><!--SRC=[pLZRSjis47tNLs3yOjcnLEVI6wVDZ6hJiQQMxKXo-vY1oPM4XWGO07JioVW3-XTzQ_mT-h4kIF1EEf7SpbGF4WNkBXPdxr3l6O-ef24960Tz5m4HKgz4J-Kl8kgzfqkOwRi0Y0HFKxuCeDVJJEF2x4xfzUSGY0_aI8GXvJueCY37wmTDMH2i7tgzNVBp1XyaFxgOJ4Rdn-HoD9-xqtFyFtKtbMBL9ZjMAt99jGR9KKi9E-HJZ-0d-M8SrnVK0t89t6TycN6aDERpZ2n1s-Mntzzpo4nBf2mH23xota_10tO3VXytdoEO3fc0KWbwLCSA-Qw5283oEkC9OeLi4gWIF9EEv3U2-GdjVQ4l5nfGZjOY969HKpeNlBzl3-naTjdVpr_c3oxtQAHYD6JCWL1FCy79XvWHmuiGu6fEwmc-O3Aa2Kr_TFJh7l5Zea3UG2o7JTcN84FGw1XElZGW8yvnDrdUJZ6YMGWYrYMw2MWjWQp_8d-8M99Wr_YJ9i39Gl2K3pqks4KrIbnlrWyIXGVeWY0bggKC5HwUhJzBSqQs4AXKBsTv6nj31vI4A7ybaBXYH_HtZTkZhbh6S92p8ODddPs0qWOQnNpSVFq0oHjamDCpZlzp9iG2mQ94nL4aMMX84RybykDfE6KIKX0DxiR6XSMzW2fLC_I4SlGhMNBI0Oag50gzZqO_fRvqK6D_NM9JtWfyOnLqFFlekxVWnLh86PgNUL2Y_gJG4Cox9yVkoUZgRFvkFfwu5rVpTvEPGmB1b-HdylBmtU7XOS4qAFbxwp7wUoKAwljLehu5swanbmCaPLtXQW1eGHE13i476u1DKWcXk87sZSP-AGOx0kmPKQjO- -8ZxsyJgFRWfNYTWehGZ-Wr2vXUFoYd5B3FXuLl4-_E2vA4UyFCZyfzKUNqBuPadiOKeMX64xGVOY3zbuSA4xeawAiBV56W_d9ed2N23J2YaEUsHUWh5Bh25EKF55rW-Dw0Xxc5Up666jUdLArGH8SBjpkl60p83YxSxTHHlj-gR9mVJTsvczMFsHDg1lSmzFEIfYe58mt76IeyXrjj7Imh6YoC0WWH3zLTJWQauMUbTs4gCAyT5JP-0r8bANWAaL0CG_JEPFXY_IXWk7lnjZqAsxLl-lz1Gvq3Z9olstdl_ra_wRNI4cjFoOwfFngh_LVMh9p6_EasIvSoZnYd8Nrpw3T1C0NkAlAfXai5iIyoLD2Zy0HV0BKC7OUFgOGcT6LSMlPgWwCXRUzf7dRVAvttGgz0khVKkCJMvzLKeZski14mUcFhMQx38eHaanC60RxLdMxIeaeR78tD3bhtU398soJhYJkRZTwuP3OVpQyspjJ0ux2gb4LvvfuVZy_VPC_pvE7OFHl_vaxTu-JVr1sb3oUZyPbTi-W-AxgRXHHXYcDVbSAXigVbqS8I5i65YDIgVvDn_IS-OuEw6_CiZebFkJ8bNjcnAcsT1zcn7DC0UoBfQtU1OsmMx-SE9kRrtt5Itus8j36t13a4DIhVj9-SQjD-MbA33tPoZv6ao3ba_O3zefVhafVzpTt1T1tM9RQksaQ6cKSXR2dNHIjOYKVavU8ZPhub-FPzQnflZuGI0SuRGauhsRCzTZ4YHssRjgRcbDZitD_hsZkXSeljQuBg3QbaovKs7baWaelA4F9tgOTJ8Cw09fqHOzqxdEGpiiYCP7OSD2qf9JZuU12P9k2R03mToq9csRzh0yusUMDyFdVVJ4VpySKv-NqyFoL7PsCJvrktUadJGiPSmr8cRKoByrYYbfflErdd2zrztGFgqy-N-77OmFUNg3JeVfJy84loszeK6Mep1UNDswKKMdWYo9kupjJUNV1J5B3Zqr84GNNs_5VELsf8iPoXHRWk5JDHAcHjiQBQQd2_gqDg2cpmbcJ7fVwZt-mosaoGpfS6BUmra-FWRx5RjO9s9glJPA3jX3gTTnynSmBZBS9ODzxNpQmDHVAzfrX51DF9NOj9lCLL486YgJ5liTdcojm4qVWHBsYEZ3Rezd56x6Ph-EHm-BfZs7H8hEmqsyJtCJPKYoqOicwJhsRksolt_CWbn-CHvgt9fX8IWr3JOU80ppquPXJpLDXBxmncwuTqEQl1oNsNpUB9W8wsoIuIUlOcmRWz6RnkOESqWd3d5890x1oG5scF-6BO11m5JJBtmw4PmyHUvhni9ovFZ8wvwyaZLTbs_LKxO_l8wfYct_2EVHo7CX7VjejejR3JTk4K-gcWxuOTRc4KAkxDiYkqx2OpkMb99NpV0KEovfJpkWdKYLeEjR0BUtk5tGOO1ZEMX5hQm0ri8lXXICmbNLLguU0PD7a3cChySTWI1Dq8LUxLKWdF3n-3fiDMrV6YfjFpvyEkMvMoaodGQR5gyBzuZD-zGMH-YR6PZ-BhWAbLlrBvZl28s8ubL4tOCxEMGS-i_mXi6Pj7W-0QaSkWtmutEwBls9kzdS8E6w6MDkzV0_b6a3sX-P-wPqb3j_4OMBkJCKcyEXJQd5zg_WU36aslu_ojmf8s86Nf7FSxjVW7]--></g></svg>